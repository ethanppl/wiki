<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">How I use keyd to remap my keyboard in Ubuntu 22.04 with Wayland | Ethan&#x27;s Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wiki.ethanppl.com/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://wiki.ethanppl.com/img/logo.png"><meta data-rh="true" property="og:url" content="https://wiki.ethanppl.com/blog/2024/09/08/keyd"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="author" content="Ethan Pang"><meta data-rh="true" name="keywords" content="wiki, guides, resources, collections"><meta data-rh="true" property="og:title" content="How I use keyd to remap my keyboard in Ubuntu 22.04 with Wayland | Ethan&#x27;s Wiki"><meta data-rh="true" name="description" content="Think about how you use your keyboard. Imagine how good it would be if your"><meta data-rh="true" property="og:description" content="Think about how you use your keyboard. Imagine how good it would be if your"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-09-08T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://ethanppl.com/"><meta data-rh="true" property="article:tag" content="Ubuntu,Tips &amp; Configs,Computers"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wiki.ethanppl.com/blog/2024/09/08/keyd"><link data-rh="true" rel="alternate" href="https://wiki.ethanppl.com/blog/2024/09/08/keyd" hreflang="en"><link data-rh="true" rel="alternate" href="https://wiki.ethanppl.com/blog/2024/09/08/keyd" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://wiki.ethanppl.com/blog/2024/09/08/keyd","mainEntityOfPage":"https://wiki.ethanppl.com/blog/2024/09/08/keyd","url":"https://wiki.ethanppl.com/blog/2024/09/08/keyd","headline":"How I use keyd to remap my keyboard in Ubuntu 22.04 with Wayland","name":"How I use keyd to remap my keyboard in Ubuntu 22.04 with Wayland","description":"Think about how you use your keyboard. Imagine how good it would be if your","datePublished":"2024-09-08T00:00:00.000Z","author":{"@type":"Person","name":"Ethan Pang","url":"https://ethanppl.com/","image":"https://github.com/ethanppl.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://wiki.ethanppl.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Ethan&#39;s Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Ethan&#39;s Wiki Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SCMKX3W2PG"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SCMKX3W2PG",{anonymize_ip:!0})</script>




<script src="https://plausible.ethanppl.com/js/script.js" async defer="defer" data-domain="wiki.ethanppl.com"></script><link rel="stylesheet" href="/assets/css/styles.5f1d9342.css">
<script src="/assets/js/runtime~main.5f704e8d.js" defer="defer"></script>
<script src="/assets/js/main.e479604d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><link rel="preload" as="image" href="https://github.com/ethanppl.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Ethan&#x27;s Wiki Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="Ethan&#x27;s Wiki Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Ethan&#x27;s Wiki</b></a><a class="navbar__item navbar__link" href="/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blogs</a><a class="navbar__item navbar__link" href="/subscribe">Subscribe</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://ethanppl.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About me<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/ethanppl/wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All Posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/10/19/karabiner">How I use Karabiner to remap my Mac keyboard</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/05/25/self-host">My $4/month self-hosted web server setup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/02/23/js-array">Reimplement all JavaScript Array Functions with while loops only</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/12/28/mfa-totp">How does the 6 digits number in multifactor authentication works?</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2024/09/08/keyd">How I use keyd to remap my keyboard in Ubuntu 22.04 with Wayland</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/06/19/weird-issue">Don&#x27;t say it&#x27;s a weird bug, because it makes you look stupid</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/02/29/dual-boot-guide">Dual Boot Windows and Ubuntu with Secure Boot and Full Disk Encryption</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">How I use keyd to remap my keyboard in Ubuntu 22.04 with Wayland</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-09-08T00:00:00.000Z">September 8, 2024</time> · <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://ethanppl.com/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/ethanppl.png" alt="Ethan Pang"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://ethanppl.com/" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Ethan Pang</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Think about how you use your keyboard. Imagine how good it would be if your
<code>CapsLock</code> can be used as <code>Ctrl</code>, how much better it would be for your left
pinky? That is the power of remapping the keyboard. It means you can customize
the functionality of each key on your keyboard.</p>
<p>This is a walkthrough of my setup in Ubuntu using <code>keyd</code>. A guide I wish it
existed when I first try to find out how to remap my keyboard in Ubuntu.</p>
<p><img decoding="async" loading="lazy" src="https://imgs.xkcd.com/comics/borrow_your_laptop.png" alt="xkcd 1806" class="img_ev3q"></p>
<p><em><a href="https://xkcd.com/1806/" target="_blank" rel="noopener noreferrer" class="">xkcd 1806: borrow your laptop</a></em></p>
<p><em>In reality, there are very few situations where my configuration would make</em>
<em>my keyboard unusable by other people. You&#x27;ll see below.</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-i-remap-my-keyboard">Why I Remap my Keyboard<a href="#why-i-remap-my-keyboard" class="hash-link" aria-label="Direct link to Why I Remap my Keyboard" title="Direct link to Why I Remap my Keyboard" translate="no">​</a></h2>
<p>After I <a class="" href="/blog/2024/02/29/dual-boot-guide">dual-boot with Ubuntu</a> and used it as
my daily driver for work and personal use, one key thing I missed is
<a href="https://www.autohotkey.com/" target="_blank" rel="noopener noreferrer" class="">AutoHotkey</a>. It is a software that I used to remap
my keyboard in Windows and create shortcuts and &quot;hotstrings&quot;. For example,</p>
<ul>
<li class="">Remapping <code>CapsLock</code> to <code>Ctrl</code> on hold, but works as <code>Esc</code> when clicked alone</li>
<li class=""><code>z+d</code> to scroll down and <code>z+u</code> to scroll up, and other ways to move my mouse</li>
<li class=""><code>z+e</code> and <code>z+g</code> to insert my email addresses</li>
<li class=""><code>|!=</code>, <code>|-&gt;</code>, <code>|&lt;-</code> will be replaced by not equal (≠), right arrow (→) and
left arrow (←), etc., automatically</li>
</ul>
<p>I shared
<a href="https://github.com/ethanppl/ahk" target="_blank" rel="noopener noreferrer" class="">my AHK configuration in this repository</a> if
you are interested. I might write about it later too.</p>
<p>I think remapping keyboard is one of the most important change I made to my
laptop ever since I know how to use a computer. It is like the first time you
discovered you can use <code>Ctrl+C</code> rather than right click and select copy. I
highly encourage everyone to try it, especially for keys like <code>CapsLock</code> that is
in a very convenient location but is rarely used.</p>
<p>So once I boot to Ubuntu, the first thing I wanted to do is to replicate this
setup. Unfortunately, AHK only works for Windows, so I need to look for
alternatives. The first difficulty that you might face as well is Ubuntu 22.04
by default uses <a href="https://en.wikipedia.org/wiki/Wayland_(protocol)" target="_blank" rel="noopener noreferrer" class="">Wayland</a> as
the window system, but a lot of tools available online works for
<a href="https://en.wikipedia.org/wiki/X_Window_System" target="_blank" rel="noopener noreferrer" class="">X11</a> only. For example, there is
<a href="https://github.com/autokey/autokey" target="_blank" rel="noopener noreferrer" class="">AutoKey</a> that seems to be popular but only
works for X11.</p>
<p>I first tried <a href="https://github.com/sezanzeb/input-remapper" target="_blank" rel="noopener noreferrer" class=""><code>input-remapper</code></a>. It
looks promising with nice graphical user interface, but it didn&#x27;t work out when
I tried to add more complicated logics. I also tried
<a href="https://github.com/boppreh/keyboard" target="_blank" rel="noopener noreferrer" class="">keyboard</a>, a Python module which allows me
to create custom keyboard events in Python code. It&#x27;s like coding my own daemon,
but I found it too much overhead and quite laggy. In the end, I found
<a href="https://wiki.archlinux.org/title/Input_remap_utilities" target="_blank" rel="noopener noreferrer" class="">a list of input remapping utilities</a>
provided by Arch Linux wiki. Going through the list and I chose
<a href="https://github.com/rvaiya/keyd" target="_blank" rel="noopener noreferrer" class=""><code>keyd</code></a> which works for me quite well over the
past year.</p>
<p>If you are using Windows, you can check
<a href="https://www.autohotkey.com/" target="_blank" rel="noopener noreferrer" class="">AutoHotkey</a> as linked above. If you are using Mac,
or would like to replicate the following set up in Mac, you can check out
<a class="" href="/blog/2025/10/19/karabiner">how I use Karabiner to remap my Mac keyboard</a>. If
your keyboard supports it,
<a href="https://docs.qmk.fm/#/newbs" target="_blank" rel="noopener noreferrer" class="">QMK</a>/<a href="https://www.caniusevia.com/docs/specification" target="_blank" rel="noopener noreferrer" class="">VIA</a>
might be good for you. Even if <code>keyd</code> doesn&#x27;t work for you, you may follow along
to get some inspiration even though the syntax of the config is not the same.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="basic-concepts-in-keyd">Basic Concepts in <code>keyd</code><a href="#basic-concepts-in-keyd" class="hash-link" aria-label="Direct link to basic-concepts-in-keyd" title="Direct link to basic-concepts-in-keyd" translate="no">​</a></h2>
<p>The very first thing to understand in <code>keyd</code> config is it operates in terms of
layers. The most intuitive way for me to understand a layer is the <code>Shift</code> key.
When the <code>Shift</code> key is pressed and hold, a different layer is activated and all
the keys on your keyboard have a different meaning. And what <code>keyd</code> allows you
to do is to define custom layers, that is, defining how the layers are activated
and deactivated, and what each key means in each of the defined layer.</p>
<p>The major reason I select <code>keyd</code> is it works in X, sway and gnome in Wayland.
Second, it natively supports key overloading, which allows me to configure the
<code>CapsLock</code> key to behave as <code>Ctrl</code> on hold while <code>Esc</code> when tapped. From what I
test, it is instant and fast too.</p>
<p>To get started, install <code>keyd</code> from source. Clone
<a href="https://github.com/rvaiya/keyd" target="_blank" rel="noopener noreferrer" class="">the repository</a> and build it from source.
Follow the instructions in the
<a href="https://github.com/rvaiya/keyd?tab=readme-ov-file#from-source" target="_blank" rel="noopener noreferrer" class="">README</a> to
install it.</p>
<p>Here are some helpful commands to know:</p>
<ul>
<li class=""><code>sudo systemctl enable keyd</code>: start <code>keyd</code>, probably run it once in your
lifetime</li>
<li class=""><code>sudo keyd reload</code>: reload the config every time after you edit the config</li>
<li class=""><code>sudo keyd monitor</code>: print key events, useful to debug what is remapped</li>
<li class=""><code>keyd list-keys</code>: list all the valid key names, useful to check the
possibilities</li>
<li class=""><code>backspace+escape+enter</code> keyboard combo: terminate <code>keyd</code> anywhere anytime in
case you severely messed up (happened once to me)</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="sharing-my-configuration">Sharing my Configuration<a href="#sharing-my-configuration" class="hash-link" aria-label="Direct link to Sharing my Configuration" title="Direct link to Sharing my Configuration" translate="no">​</a></h2>
<p>Here is the full config if you are interested. I will explain it line by line
below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[ids]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[main]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Maps capslock to escape when pressed and control when held.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capslock = overload(control, esc)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Maps z to a custom layer, but just &#x27;z&#x27; when pressed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">z = overload(z, z)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Shift layer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[shift:S]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## shift+capslock is capslock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capslock = capslock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom z layer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[z]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Escape common patterns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i = macro(zi)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o = macro(zo)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Emails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e = macro(hi@ethanppl.com)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g = macro(hi@ethanppl.com)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Simplify complicated shortcut keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v = C-S-v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">n = C-S-a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x = A-f4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s = command(systemctl suspend)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Arrows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">j = down</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k = up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">h = left</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">l = right</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Media / modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m = oneshot(media)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[media]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">j = previoussong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k = playpause</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">l = nextsong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a = macro({ enter 10ms &quot;Aut 10ms hor 10ms iza 10ms tio 10ms n&quot;: space &quot;Bea 10ms rer space C-v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="main-layer">Main layer<a href="#main-layer" class="hash-link" aria-label="Direct link to Main layer" title="Direct link to Main layer" translate="no">​</a></h3>
<p>Let&#x27;s go through it line by line.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">capslock = overload(control, esc)</span><br></span></code></pre></div></div>
<p>This is the most important feature that I need, as introduced in the beginning.
According to the man page, <code>overload(&lt;layer&gt;, &lt;action&gt;)</code> &quot;activates the layer on
hold while executes the action on tap&quot;. This line means <code>CapsLock</code> will act like
<code>Ctrl</code> when used with other keys. But when I tap it only, it works as <code>Esc</code>.
This makes key combo like <code>Ctrl+C</code> way easier than before, where the <code>Ctrl</code> key
is in the bottom left. It also makes <code>Esc</code> easier, which is used a lot in Vim.
This single line is the biggest reason why I picked <code>keyd</code>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">z = overload(z, z)</span><br></span></code></pre></div></div>
<p>This might seem weird when you first look at it, but think about the key <code>z</code> as
its own layer (remember, layer is like the <code>Shift</code> key). So when <code>z</code> is hold, it
activates a <code>z</code> layer, like holding the <code>Shift</code> key activate the shift layer,
but it acts as <code>z</code> when tap alone. This gives me another modifier key (e.g.
<code>Ctrl</code>, <code>Alt</code>, <code>Shift</code>), without overriding what the default keyboard shortcuts
that come with software programs. But before we go into this special <code>z</code> layer,
we need to fix one thing first.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="shift-layer">Shift layer<a href="#shift-layer" class="hash-link" aria-label="Direct link to Shift layer" title="Direct link to Shift layer" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[shift:S]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capslock = capslock</span><br></span></code></pre></div></div>
<p>We don&#x27;t have a <code>CapsLock</code> key after we remap it. What this two lines do is
that, in the shift layer, map <code>CapsLock</code> to work as <code>CapsLock</code>. So to summarize,
right now holding <code>CapsLock</code> is <code>Ctrl</code>, tapping <code>CapsLock</code> once is <code>Esc</code>, and
doing <code>Shift+CapsLock</code> is <code>CapsLock</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-z-layer">The <code>z</code> layer<a href="#the-z-layer" class="hash-link" aria-label="Direct link to the-z-layer" title="Direct link to the-z-layer" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i = macro(zi)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o = macro(zo)</span><br></span></code></pre></div></div>
<p>First thing is since I did this custom <code>z</code> layer with AutoHotkey in Windows, I
realized the character <code>i</code> and <code>o</code> commonly follows the <code>z</code> key (e.g. amazing
and amazon). To avoid delay in typing or keys being ignored because I typed <code>i</code>
before releasing <code>z</code>. I mapped press and hold <code>z</code> then <code>i</code> (<code>z+i</code>) to output
<code>zi</code> and <code>z+o</code> to output <code>zo</code> here.</p>
<p>I use <code>+</code> sign to mean press and hold the first key and type the second key. But
<code>keyd</code> use <code>+</code> sign to mean chording, which means two keys to be pressed at the
same time. I didn&#x27;t use chording in my config and most of the documentation for
keyboard shortcuts often use <code>+</code> sign like <code>Ctrl+c</code>, so I hope it&#x27;s easy to
understand.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">e = macro(hi@ethanppl.com)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g = macro(hi@ethanppl.com)</span><br></span></code></pre></div></div>
<p>Next, I mapped <code>z+e</code> and <code>z+g</code> to two emails that I used the most for
communication and sign in. You will be amazed how many times you type your email
each day. And how much better you don&#x27;t need to type <code>@</code> anymore.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">v = C-S-v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">n = C-S-a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x = A-f4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s = command(systemctl suspend)</span><br></span></code></pre></div></div>
<p>Here I simplified some commonly used shortcuts with the <code>z</code> layer. In <code>keyd</code>,
capitalized <code>C</code>, <code>S</code> and <code>A</code> means <code>Ctrl</code>, <code>Shift</code> and <code>Alt</code> key respectively.
And the hyphen <code>-</code> means press and hold. For example, <code>z+v</code> is an alias of
<code>Ctrl+Shift+V</code> which is often used as paste text only or the markdown preview in
VSCode. <code>z+n</code> is an alias of <code>Ctrl+Shift+a</code> which shows information of all tabs
in Chrome. <code>z+x</code> is an alias of <code>Alt-F4</code> which closes a window. And <code>z+s</code> run
the <code>systemctl suspend</code> command, which will suspend the laptop. I find this
helpful, and somehow I trust it to suspend my laptop successfully more than just
closing the lid of my laptop.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">j = down</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k = up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">h = left</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">l = right</span><br></span></code></pre></div></div>
<p>Here I mapped <code>j</code>, <code>k</code>, <code>h</code>, <code>l</code> to be arrow keys. For example, holding <code>z+l</code>
will produce the right arrow key. The reason for these mappings (e.g. why <code>j</code> is
down) are based on Vim motions. These are helpful because arrows are usually
unreachable unless I move my palm away from my keyboard. Doing <code>z+l</code> allows me
to do things like autocomplete in terminal without moving my palm.</p>
<p>You might also notice that I try to pair keys that are comfortable to reach when
holding <code>z</code> down, like I would avoid mapping anything to <code>z+a</code> that is just
complicated and unnatural to type.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-zm-layer-a-layer-on-top-of-a-layer">The <code>z+m</code> layer, a layer on top of a layer<a href="#the-zm-layer-a-layer-on-top-of-a-layer" class="hash-link" aria-label="Direct link to the-zm-layer-a-layer-on-top-of-a-layer" title="Direct link to the-zm-layer-a-layer-on-top-of-a-layer" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">m = oneshot(media)</span><br></span></code></pre></div></div>
<p>Still in the <code>z</code> layer, I defined the <code>m</code> key to activate the <code>media</code> layer. It
activates this layer as <code>oneshot</code>. The man page defined <code>oneshot</code> as &quot;If tapped,
activate the supplied layer for the duration of the next key press&quot;. It means
the layer is activated once tapped, and it will be toggled off only after
another key is pressed. This means the <code>media</code> layer is activated once we tap
<code>z+m</code>, and we don&#x27;t have to hold it for it to be active (unlike the <code>shift</code> or
<code>z</code> layer).</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[media]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">j = previoussong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k = playpause</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">l = nextsong</span><br></span></code></pre></div></div>
<p>I discovered these keys when browsing through the <code>keyd list-keys</code> command. And
Ubuntu support these keys. How this works is once I pressed <code>z+m</code>, then tap <code>l</code>,
it will emit a <code>nextsong</code> key press. What this allows me to do is whichever
active window I am in, I can use <code>z+m</code>, then <code>j</code>, <code>k</code>, or <code>l</code> to go back, pause,
or skip a song in Spotify, which I think is pretty amazing.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a = macro({ enter 10ms &quot;Aut 10ms hor 10ms iza 10ms tio 10ms n&quot;: space &quot;Bea 10ms rer space C-v)</span><br></span></code></pre></div></div>
<p>One last line which doesn&#x27;t relate to media actually, but I put it in any way.
It is used to help me type the authorization header in GraphQL playground. What
I have to do is copy the token that I want to use, then type <code>z+m</code> and <code>a</code>, it
will help me generate the whole</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Authorization&quot;: &quot;Bearer &lt;token_copied_here&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>It is taking advantage of the GraphQL playground I used that will help me close
the <code>{</code> curly braces. With some trial and error I realize I cannot make <code>keyd</code>
to type all keys at once, so I leave some delay in between and that works
better. Having it run <code>Ctrl+V</code> to paste also helps a lot. I find this saves me
quite some time each day.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="other-thoughts">Other thoughts<a href="#other-thoughts" class="hash-link" aria-label="Direct link to Other thoughts" title="Direct link to Other thoughts" translate="no">​</a></h2>
<p>There are many other features in <code>keyd</code> that is up to you to explore. I have
added different configs in and out over the year until I settle down to this set
of commands. For example, initially I also configured a shortcut to type
<code>console.log</code> and <code>IO.inspect</code> for TypeScript and Elixir, other than the
authorization header shortcut, but I found out I rarely used them and I removed
them.</p>
<p>I also tried <code>oneshot(shift)</code> which is recommended in the <code>keyd</code> README. But it
didn&#x27;t work for me. I find out I often tap <code>Shift</code> but changed my mind
afterwards, which makes me accidentally typed characters in uppercase. I also
find out <code>oneshot(shift)</code> doesn&#x27;t work well with Shift and drag to select in
bulk with mouse because it doesn&#x27;t understand there is a mouse click and
deactivate the shift layer after I realize the <code>Shift</code> key.</p>
<p>Another thing I found is the <code>command()</code> call doesn&#x27;t always work. I once
installed <code>copyq</code> to get clipboard history and I configured <code>z+c</code> to be
<code>command(copyq show)</code>, but it never worked. It&#x27;s not a dealbreaker and I didn&#x27;t
spend time to debug why.</p>
<p>One thing you might already notice is there is no more hotstrings, which I had
in <a href="https://github.com/ethanppl/ahk" target="_blank" rel="noopener noreferrer" class="">my AutoHotkey configuration</a>. I can no
longer type <code>≠</code>, <code>→</code>, <code>←</code> and other special characters that easily. I realize
configuration like <code>l = ←</code> doesn&#x27;t work. After reading the man page, I believe I
can make it works by setting up Unicode support, which have some other external
configuration required, and I have not spent the time investigating.</p>
<p>There is also no more mouse control. There is no way to move my mouse with
<code>keyd</code> because all <code>keyd</code> does is to remap keys. I know there are other daemons
in Linux that are designed for that, but I have not tried. There are
<a href="https://github.com/rvaiya/warpd" target="_blank" rel="noopener noreferrer" class=""><code>warpd</code></a> for X11, macOS, or Sway only, but not
Wayland in gnome.</p>
<p>There are also some minor problems that I wish to solve in the future. For
example, <code>Ctrl+&lt;arrows&gt;</code> is a common key combination that I do, but I can&#x27;t
easily do that with <code>CapsLock+z+&lt;hjkl&gt;</code> because the relative position of
<code>CapsLock</code> and <code>z</code> is too close.</p>
<p>I would like to try mapping specific shortcuts to specific applications too. But
most of the time I find the default configs coming with the app works good
enough. Also, I did not configure any keys to launch an application because I
find <code>meta+&lt;num&gt;</code> good enough to open the windows that are pinned to the task
bar. For example, <code>win+2</code> always open my browser and <code>win+3</code> open VSCode.</p>
<p>That is how my configuration in <code>keyd</code> works and some of my reasoning behind it.
I hope you like this explanation, and it inspires you to remap your keyboard
too. It genuinely improved my life.</p>
<p><em>You might be interested in <a class="" href="/computers/keyboard">this page about keyboards</a> in
my Wiki too.</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="useful-links">Useful links<a href="#useful-links" class="hash-link" aria-label="Direct link to Useful links" title="Direct link to Useful links" translate="no">​</a></h2>
<ul>
<li class=""><a href="https://github.com/rvaiya/keyd" target="_blank" rel="noopener noreferrer" class=""><code>keyd</code> repository</a></li>
<li class=""><a href="https://github.com/rvaiya/keyd/tree/master/examples" target="_blank" rel="noopener noreferrer" class=""><code>keyd</code> examples</a> by the
creator</li>
<li class="">If you are stuck, you might find a solution by searching the
<a href="https://github.com/rvaiya/keyd/issues" target="_blank" rel="noopener noreferrer" class="">issues in <code>keyd</code></a></li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/ubuntu">Ubuntu</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tips-and-configs">Tips &amp; Configs</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/computers">Computers</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024/12/28/mfa-totp"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">How does the 6 digits number in multifactor authentication works?</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2024/06/19/weird-issue"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Don&#x27;t say it&#x27;s a weird bug, because it makes you look stupid</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-i-remap-my-keyboard" class="table-of-contents__link toc-highlight">Why I Remap my Keyboard</a></li><li><a href="#basic-concepts-in-keyd" class="table-of-contents__link toc-highlight">Basic Concepts in <code>keyd</code></a></li><li><a href="#sharing-my-configuration" class="table-of-contents__link toc-highlight">Sharing my Configuration</a><ul><li><a href="#main-layer" class="table-of-contents__link toc-highlight">Main layer</a></li><li><a href="#shift-layer" class="table-of-contents__link toc-highlight">Shift layer</a></li><li><a href="#the-z-layer" class="table-of-contents__link toc-highlight">The <code>z</code> layer</a></li><li><a href="#the-zm-layer-a-layer-on-top-of-a-layer" class="table-of-contents__link toc-highlight">The <code>z+m</code> layer, a layer on top of a layer</a></li></ul></li><li><a href="#other-thoughts" class="table-of-contents__link toc-highlight">Other thoughts</a></li><li><a href="#useful-links" class="table-of-contents__link toc-highlight">Useful links</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a class="footer__link-item" href="/">About</a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/blog">Blogs</a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/subscribe">Subscribe for free</a><span class="footer__link-separator">·</span><a href="https://ethanppl.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">About me<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><span class="footer__link-separator">·</span><a href="https://github.com/ethanppl/wiki/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report an issue<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Ethan Pang.</div></div></div></footer></div>
</body>
</html>