<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Dual Boot Windows and Ubuntu with Secure Boot and Full Disk Encryption | Ethan&#x27;s Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wiki.ethanppl.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wiki.ethanppl.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wiki.ethanppl.com/blog/2024/02/29/dual-boot-guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="wiki, guides, resources, collections"><meta data-rh="true" property="og:title" content="Dual Boot Windows and Ubuntu with Secure Boot and Full Disk Encryption | Ethan&#x27;s Wiki"><meta data-rh="true" name="description" content="A few months ago, I finally took the time to set up dual boot on my laptop. I"><meta data-rh="true" property="og:description" content="A few months ago, I finally took the time to set up dual boot on my laptop. I"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-02-29T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/ethanppl"><meta data-rh="true" property="article:tag" content="Dual Boot,Ubuntu,Windows"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wiki.ethanppl.com/blog/2024/02/29/dual-boot-guide"><link data-rh="true" rel="alternate" href="https://wiki.ethanppl.com/blog/2024/02/29/dual-boot-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://wiki.ethanppl.com/blog/2024/02/29/dual-boot-guide" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://wiki.ethanppl.com/blog/2024/02/29/dual-boot-guide","mainEntityOfPage":"https://wiki.ethanppl.com/blog/2024/02/29/dual-boot-guide","url":"https://wiki.ethanppl.com/blog/2024/02/29/dual-boot-guide","headline":"Dual Boot Windows and Ubuntu with Secure Boot and Full Disk Encryption","name":"Dual Boot Windows and Ubuntu with Secure Boot and Full Disk Encryption","description":"A few months ago, I finally took the time to set up dual boot on my laptop. I","datePublished":"2024-02-29T00:00:00.000Z","author":{"@type":"Person","name":"Ethan Pang","url":"https://github.com/ethanppl","image":"https://github.com/ethanppl.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://wiki.ethanppl.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Ethan&#39;s Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Ethan&#39;s Wiki Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SCMKX3W2PG"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SCMKX3W2PG",{anonymize_ip:!0})</script>



<script src="https://plausible.ethanppl.com/js/script.js" async defer="defer" data-domain="wiki.ethanppl.com"></script><link rel="stylesheet" href="/assets/css/styles.df0e0538.css">
<script src="/assets/js/runtime~main.a717f071.js" defer="defer"></script>
<script src="/assets/js/main.acb1e289.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Wiki Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="My Wiki Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Personal Wiki</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ethanppl/wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/06/19/weird-issue">Don&#x27;t say it&#x27;s a weird bug, because it makes you look stupid</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2024/02/29/dual-boot-guide">Dual Boot Windows and Ubuntu with Secure Boot and Full Disk Encryption</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Dual Boot Windows and Ubuntu with Secure Boot and Full Disk Encryption</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-02-29T00:00:00.000Z">February 29, 2024</time> Â· <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/ethanppl" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/ethanppl.png" alt="Ethan Pang"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/ethanppl" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Ethan Pang</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>A few months ago, I finally took the time to set up dual boot on my laptop. I
would love to try Ubuntu as my daily driver again, while keeping the Windows OS
just in case. I treated this as a learning opportunity and configured dual boot
with secure boot still enabled and have full disk encryption configured for both
operating systems.</p>
<p>I wrote this blog because I could not find a single guide explains all steps for
secure boot and full disk encryption sequentially, and these steps interleave
each other. So, I made some notes before the installation to ensure I am doing
the right thing at the right time. For example, I won&#x27;t accidentally skip a step
about configuring secure boot when I am focused on following another guide about
full disk encryption. This guide is a cleaned up version of the notes that I
compiled for my dual boot set up.</p>
<p>I organized the whole flow into 6 general steps:</p>
<ol>
<li>Preparing in Windows: set boot mode, partition disk, etc.</li>
<li>Configure BIOS: boot mode and other BIOS settings</li>
<li>Configure Ubuntu Partition: boot and data partition</li>
<li>Install Ubuntu: configure dual boot and mounting volumes correctly</li>
<li>Set up <code>crypttab</code> for full disk encryption</li>
<li>Reboot and fix some other issues</li>
</ol>
<p>You can do step 1 and 2 separately. From step 3 onwards, I suggest doing in 1
sitting, which might take an hour or more.</p>
<p>What I have is a Lenovo ThinkPad X1 Carbon 7th Gen laptop, running Windows 11
home and I would like it to dual boot into Ubuntu 22.04. And, as mentioned, with
secure boot enabled in the boot process and full disk encryption for both
operating systems.</p>
<p>Now the system has been running for a few months and things work fine. No issue
with booting or decrypting the disk. It&#x27;s a good time to document the steps and
share the resources that I found helpful. Hopefully this is helpful to others
and maybe one day my future self.</p>
<p><strong>Dual boot is stressful and it has risk. This guide by no means is complete.</strong>
I have dual boot a few times before, so I kind of know how things look like. To
me, it&#x27;s helpful to watch YouTube video of people dual booting before doing it
to understand what to expect. Also, check a few more guides, compare and
understand which part is common and which part is custom.</p>
<p><strong>Make sure you have access to guides and notes on mobile or another device.</strong>
You won&#x27;t be able to access notes in the device during dual boot. Things might
break after dual booting. Maybe the Wi-Fi card driver is not working, or
graphics card config is wrong, or the pointer device is unusable. You will need
another device to access your notes or search the Internet for answers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparation-in-windows">Preparation in Windows<a href="#preparation-in-windows" class="hash-link" aria-label="Direct link to Preparation in Windows" title="Direct link to Preparation in Windows">â</a></h2>
<p>Let&#x27;s start!</p>
<p>The first step is to prepare for dual boot. All the steps in this stage are done
within the Windows. There is no specific order for these steps and no need to do
it in 1 sitting. I had my laptop running on Windows, so all the preparation are
done in Windows.</p>
<ul>
<li>UEFI, not BIOS<!-- -->
<ul>
<li>On Windows: <code>System Information</code> â <code>BIOS Mode</code> = <code>UEFI</code> instead of <code>Legacy</code></li>
<li><code>UEFI</code> is required for secure boot, GUID partition table (GPT) t&#x27;s faster,
and many other features</li>
<li>Read more here: <a href="https://itsfoss.com/check-uefi-or-bios/" target="_blank" rel="noopener noreferrer">https://itsfoss.com/check-uefi-or-bios/</a></li>
</ul>
</li>
<li>GPT, not MBR<!-- -->
<ul>
<li>On Windows: <code>Disk management</code> â <code>Create and format hard disk partitions</code> â
right-click disk â <code>Properties</code> â <code>Volume</code> â <code>Partition style</code> =
<code>GUID Partition Table (GPT)</code></li>
<li>Read more here: <a href="https://itsfoss.com/check-mbr-or-gpt/" target="_blank" rel="noopener noreferrer">https://itsfoss.com/check-mbr-or-gpt/</a></li>
</ul>
</li>
<li>Use <a href="https://rufus.ie/en/" target="_blank" rel="noopener noreferrer">Rufus</a> to create the bootable USB<!-- -->
<ul>
<li>Get the <a href="https://ubuntu.com/download/desktop" target="_blank" rel="noopener noreferrer">Ubuntu Desktop Image</a></li>
<li>Partition scheme: Select <code>GPT</code></li>
<li>Target System: Select <code>UEFI</code></li>
</ul>
</li>
<li>Backup BitLocker recovery key<!-- -->
<ul>
<li>Make sure your BitLocker recovery key is saved to your Microsoft account, or
any other ways of backing it up</li>
<li>Read more on how to back up in
<a href="https://support.microsoft.com/en-us/windows/back-up-your-bitlocker-recovery-key-e63607b4-77fb-4ad3-8022-d6dc428fbd0d" target="_blank" rel="noopener noreferrer">Microsoft official guide</a></li>
</ul>
</li>
<li>Partition your disk<!-- -->
<ul>
<li>Assuming Windows now taking up the full disk, you will need to shrink the
volume available to Windows and create space for Linux</li>
<li>Disable BitLocker<!-- -->
<ul>
<li>I had to disable BitLocker to shrink the Windows volume</li>
<li>Follow the on-screen instructions for each to decrypt and reboot, it will
take some time</li>
<li>Read more on
<a href="https://www.diskpart.com/articles/resize-bitlocker-partition-windows-10-0725.html" target="_blank" rel="noopener noreferrer">this guide about resize BitLocker partition</a></li>
</ul>
</li>
<li>Partition<!-- -->
<ul>
<li>I used <a href="https://www.diskpart.com/download.html" target="_blank" rel="noopener noreferrer">AOMEI Partition Assistant</a></li>
<li>Read their
<a href="https://www.diskpart.com/safely-partition.html" target="_blank" rel="noopener noreferrer">How to safely partition</a>
tutorial</li>
<li>Other guides I found useful:
<a href="https://www.diskpart.com/help/align-partition.html" target="_blank" rel="noopener noreferrer">Align partition</a>,
<a href="https://www.diskpart.com/lib/PreOS-mode.html" target="_blank" rel="noopener noreferrer">PreOS Mode</a></li>
<li>If you want to use the Disk Management tool from Windows but failed,
<a href="https://answers.microsoft.com/en-us/windows/forum/all/windows-disk-management-unable-to-shrink-c-drive/217c3521-b254-4662-bac9-bc90dc633fab" target="_blank" rel="noopener noreferrer">this post</a>
might be helpful</li>
</ul>
</li>
<li>Move <code>WinRe</code> partition after the Windows partition<!-- -->
<ul>
<li>This is the recovery partition for Windows to support failover</li>
<li>It is recommended to keep this as a separate partition and put it right
after the Windows partition</li>
<li>Read more on
<a href="https://learn.microsoft.com/en-us/answers/questions/1354739/the-recovery-partition-is-typically-created-at-the" target="_blank" rel="noopener noreferrer">this post</a></li>
<li>So what I had is [Windows | WinRe | Unused space (for Ubuntu later)]</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-bios-in-the-bios-menu">Configure BIOS in the BIOS Menu<a href="#configure-bios-in-the-bios-menu" class="hash-link" aria-label="Direct link to Configure BIOS in the BIOS Menu" title="Direct link to Configure BIOS in the BIOS Menu">â</a></h2>
<p>Just to make sure a few things are set in the BIOS menu. Knowing how to get into
the BIOS menu is also helpful in case of bad things happened.</p>
<p>Reboot the computer and enter the BIOS menu before the OS load. Search online
how to do it for your computer. It&#x27;s usually F2 or F12. For me is pressing Enter
when it says something like &quot;Press Enter to interrupt&quot;.</p>
<p>Things to check:</p>
<ul>
<li>Make sure the UEFI BIOS is up-to-date</li>
<li>SATA mode is <code>AHCI</code>, as Ubuntu doesn&#x27;t support other operations</li>
<li>Secure boot is enabled and CSM is disabled<!-- -->
<ul>
<li>It is required to install Ubuntu with secure boot enabled for secure boot to
work with Ubuntu</li>
<li>CSM is to support non-UEFI OS. It should already be disabled with secure
boot enabled</li>
</ul>
</li>
<li>Boot mode is UEFI only</li>
<li>TPM security has to be enabled for BitLocker in Windows</li>
<li>You can check the Boot order in the BIOS menu as well</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-ubuntu-partition">Configure Ubuntu Partition<a href="#configure-ubuntu-partition" class="hash-link" aria-label="Direct link to Configure Ubuntu Partition" title="Direct link to Configure Ubuntu Partition">â</a></h2>
<p>The important bits start here! From now on, it&#x27;s better to do all remaining
steps in one go.</p>
<p>This stage is to boot into Ubuntu with the live USB and configure the Ubuntu
partition that is encrypted.</p>
<ol>
<li>
<p>Boot the USB stick and select <code>Try without installing</code> when prompted</p>
</li>
<li>
<p>You should see the default Ubuntu desktop, open a terminal</p>
</li>
<li>
<p>In the terminal, change to root with</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo su</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Check the partition table again</p>
<ol>
<li>Check with <code>sgdisk</code>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sgdisk --print /dev/nvme0n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>If your disk is not <code>/dev/nvme0n1</code>, then you will have to replace all the
following commands to your disk name, e.g. <code>/dev/sda</code></li>
<li>Look for the disk name (e.g. <code>/dev/sda</code> or <code>/dev/nvme0n1</code>) not the
partition name (e.g. <code>/dev/sda1</code> or <code>/dev/nvme0n1p1</code>)</li>
</ol>
</li>
<li>
<p>Create 2 partitions in the empty space in your disk, one for boot and the
rest for root</p>
<ol>
<li>New 1800M partition for boot<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sgdisk --new=5:0:+1800M /dev/nvme0n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>New partition using the rest for root<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sgdisk --new=6:0:0 /dev/nvme0n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>Name the partitions<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sgdisk --change-name=5:/boot --change-name=6:rootfs /dev/nvme0n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>Choose 8300 as the type code for the file system (Linux filesystem)<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sgdisk --typecode=5:8300 --typecode=6:8300 /dev/nvme0n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->(you can find all typecode with <code>sgdisk -L</code>)</li>
<li>Make EXT4 file system (notice that here is the partition name)<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.ext4 -L boot /dev/nvme0n1p5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
</li>
<li>
<p>Encrypt the Linux data partition with LUKS</p>
<ul>
<li>In the following codeblock, I am showing the output as well</li>
<li>Lines after <code>#</code> are what needed to be inputted to the terminal</li>
<li>The passphrase you chose at this step is what you needed to decrypt the
disk when booting</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cryptsetup luksFormat --type=luks2 /dev/nvme0n1p6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">========</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This will overwrite data on /dev/nvme0n1p6 irrevocably.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure? (Type uppercase yes): YES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter passphrase for /dev/nvme0n1p6:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verify passphrase:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cryptsetup open /dev/nvme0n1p6 nvme0n1p6_crypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter passphrase for /dev/nvme0n1p6:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ls /dev/mapper/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">control nvme0n1p6_crypt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Set up logical volume manager (LVM), with root, swap and home partition</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># pvcreate /dev/mapper/nvme0n1p6_crypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Physical volume &quot;/dev/mapper/nvme0n1p6_crypt&quot; successfully created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># vgcreate ubuntu-vg /dev/mapper/nvme0n1p6_crypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volume group &quot;ubuntu-vg&quot; successfully created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># lvcreate -L 64G -n root ubuntu-vg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logical volume &quot;root&quot; created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># lvcreate -L 16G -n swap ubuntu-vg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logical volume &quot;swap&quot; created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># lvcreate -l 100%FREE -n home ubuntu-vg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logical volume &quot;home&quot; created.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>Now all the Ubuntu partitions are prepared. Without exiting the live
environment, use the GUI to continue the installation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-ubuntu">Install Ubuntu<a href="#install-ubuntu" class="hash-link" aria-label="Direct link to Install Ubuntu" title="Direct link to Install Ubuntu">â</a></h2>
<p>We will install Ubuntu on the encrypted disk and configure things to make sure
secure boot also works.</p>
<ol>
<li>Run the graphical installer</li>
<li>Connect to your Wi-Fi network</li>
<li>On the software step, for &quot;Other options&quot; (This step is important for secure
boot to work)<!-- -->
<ol>
<li>Check the &quot;Download updates&quot; option</li>
<li>Check the &quot;Install third-party software for graphics and Wi-Fi hardware&quot;</li>
<li>Check the &quot;Configure Secure Boot&quot; option and enter a password, remember
this password. Useful for the MOK management step explained below.</li>
<li>Save and continue</li>
</ol>
</li>
<li>When asked what to do with the disk, pick &quot;Something else&quot;, or the option
that allows you to manually assign disk partition<!-- -->
<ol>
<li>Use the ~1800MB partition as <code>ext4</code> with mount point as <code>/boot</code></li>
<li>Use the <code>/dev/mapper/ubuntu-vg-root</code> as <code>ext4</code> FS and mount it to <code>/</code></li>
<li>Use the <code>/dev/mapper/ubuntu-vg-home</code> as <code>ext4</code> FS and mount it to <code>/home</code></li>
<li>Use the <code>/dev/mapper/ubuntu-vg-swap</code> as <code>swap</code></li>
<li>Do the same as above if you have more or less partitions</li>
<li>The bootloader device should be <code>/dev/nvme0n1</code></li>
</ol>
</li>
<li>Proceed with the installation</li>
<li>When finished, select <code>Continue Testing</code>, and it should bring you back to the
Ubuntu Desktop environment</li>
</ol>
<p>Do not leave the live environment just yet.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-crypttab">Set up <code>crypttab</code><a href="#set-up-crypttab" class="hash-link" aria-label="Direct link to set-up-crypttab" title="Direct link to set-up-crypttab">â</a></h2>
<p><code>crypttab</code> is used to decrypt the disk on boot.</p>
<ol>
<li>
<p>Open the terminal and find the UUID of the partition with LUKS</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo blkid /dev/nvme0n1p6</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example output:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dev/nvme0n1p6: UUID=&quot;abcdefgh-1234-5678-9012-abcdefghijklm&quot; TYPE=&quot;crypto_LUKS&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I suggest writing the UUID down somewhere</p>
</li>
<li>
<p>Mount the drives and chroot into the mount:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mount /dev/mapper/ubuntu-vg-root /target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount /dev/nvme0n1p5 /target/boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for n in proc sys dev etc/resolv.conf; do mount --rbind /$n /target/$n; done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chroot /target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Configure <code>/etc/crypttab</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># &lt;target name&gt; &lt;source device&gt; &lt;key file&gt; &lt;options&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># options used:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     luks    - specifies that this is a LUKS encrypted device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     tries=0 - allows to re-enter password unlimited number of times</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     discard - allows SSD TRIM command, WARNING: potential security risk (more: &quot;man crypttab&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     loud    - display all warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nvme0n1p6_crypt UUID=abcdefgh-1234-5678-9012-abcdefghijklm none luks,discard</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Apply the changes (still inside chroot)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">update-initramfs -k all -c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reboot-and-some-remaining-issues">Reboot and some remaining issues<a href="#reboot-and-some-remaining-issues" class="hash-link" aria-label="Direct link to Reboot and some remaining issues" title="Direct link to Reboot and some remaining issues">â</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="blue-screen-mok-management">Blue screen MOK management<a href="#blue-screen-mok-management" class="hash-link" aria-label="Direct link to Blue screen MOK management" title="Direct link to Blue screen MOK management">â</a></h3>
<ol>
<li>When reboot, because of the secure boot, you will see a blue screen and ask
to perform MOK management</li>
<li>Choose Enroll MOK, continue, yes</li>
<li>Input the password that you inputted on the step for software install during
the installation for third party drivers<!-- -->
<ul>
<li>It won&#x27;t show what you typed, trust that it&#x27;s there</li>
<li>This is only a one time thing so no worries</li>
<li>Once successful you don&#x27;t need the password anymore</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="windows-bitlocker-issue">Windows BitLocker Issue<a href="#windows-bitlocker-issue" class="hash-link" aria-label="Direct link to Windows BitLocker Issue" title="Direct link to Windows BitLocker Issue">â</a></h3>
<p>You might need to input the BitLocker recovery key when booting into Windows.
Find your recovery key in where ever you saved (e.g. Microsoft account) and
input it. This is also one time thing, so no worries.</p>
<p>If you have disabled BitLocker before to partition the disk, you will need to
re-enable it and encrypt the Windows partition again.</p>
<p>To encrypt again, you need to make sure you meet the pre-requisites to enable
BitLocker:</p>
<ul>
<li>Check that the partition table is GPT</li>
<li>BIOS is set to UEFI</li>
<li>Secure boot is enabled</li>
</ul>
<p>Go to <code>System information</code> â scroll down and see device encryption support needs
to be <code>meets prerequisites</code>. If not, check the above again and maybe reboot and
see.</p>
<p>Once the prerequisites are met, go to Settings â privacy &amp; security â device
encryption and enable BitLocker.</p>
<p>To check the progress:</p>
<ul>
<li>Open admin command prompt and input <code>manage-bde -status C:</code></li>
<li>If the status stuck, not updating, try <code>manage-bde -pause C:</code> and then
<code>manage-bde -resume C:</code></li>
</ul>
<p>With BitLocker re-enabled, this means both Ubuntu and Windows have full disk
encryption and secure boot enabled!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wrong-timezone-after-dual-boot">Wrong timezone after dual boot<a href="#wrong-timezone-after-dual-boot" class="hash-link" aria-label="Direct link to Wrong timezone after dual boot" title="Direct link to Wrong timezone after dual boot">â</a></h3>
<p>You might notice one of the OS show the wrong time before resyncing their time.
This is because they store time into the computer hardware clock differently.
Linux assumes that the time on the hardware clock is stored in UTC and Windows
assumes it is local time. One solution is to ask Linux to store the hardware
clock as local time:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">timedatectl set-local-rtc 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://itsfoss.com/wrong-time-dual-boot/" target="_blank" rel="noopener noreferrer">Read more in this guide from It&#x27;s Foss</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">â</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-full-disk-encryption">About full disk encryption:<a href="#about-full-disk-encryption" class="hash-link" aria-label="Direct link to About full disk encryption:" title="Direct link to About full disk encryption:">â</a></h3>
<ul>
<li><a href="https://www.mikekasberg.com/blog/2020/04/08/dual-boot-ubuntu-and-windows-with-encryption.html" target="_blank" rel="noopener noreferrer">How to Dual-Boot Ubuntu 20.04 (or 22.04) and Windows 10 (or 11) with Encryption | Mike Kasberg</a> -
recommend reading</li>
<li><a href="https://gist.github.com/luispabon/db2c9e5f6cc73bb37812a19a40e137bc" target="_blank" rel="noopener noreferrer">Dual boot with encryption nodes | GitHub Gist from @luispabon</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-secure-boot">About secure boot:<a href="#about-secure-boot" class="hash-link" aria-label="Direct link to About secure boot:" title="Direct link to About secure boot:">â</a></h3>
<ul>
<li><a href="https://www.reddit.com/r/linux4noobs/comments/osotp3/ubuntu_dual_boot_with_windows_10_can_i_enable/" target="_blank" rel="noopener noreferrer">Can I enable secure boot again? | Reddit</a> -
Ans: no</li>
<li><a href="https://youtu.be/GqJBniwj1Mg" target="_blank" rel="noopener noreferrer">A Clean Install of Linux Ubuntu 20.04 (Lenovo UEFI BIOS with Secure Boot and MOK) | YouTube</a> -
worth watching parts about the secure boot and MOK step</li>
<li><a href="https://askubuntu.com/questions/880240/it-is-possible-to-dual-boot-linux-and-windows-10-with-secure-boot-enabled" target="_blank" rel="noopener noreferrer">It is possible to dual boot Linux and Windows 10 with secure boot enabled? | Ask Ubuntu</a> -
Ans: yes</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-partition-and-bitlocker">About partition and BitLocker:<a href="#about-partition-and-bitlocker" class="hash-link" aria-label="Direct link to About partition and BitLocker:" title="Direct link to About partition and BitLocker:">â</a></h3>
<ul>
<li><a href="https://answers.microsoft.com/en-us/windows/forum/all/windows-disk-management-unable-to-shrink-c-drive/217c3521-b254-4662-bac9-bc90dc633fab" target="_blank" rel="noopener noreferrer">Windows Disk Management unable to shrink C: drive volume</a></li>
<li><a href="https://www.diskpart.com/articles/resize-bitlocker-partition-windows-10-0725.html" target="_blank" rel="noopener noreferrer">How can I resize BitLocker partition in Windows 10/11</a></li>
<li><a href="https://itsfoss.com/dual-boot-ubuntu-windows-bitlocker/" target="_blank" rel="noopener noreferrer">Dual Booting Ubuntu with Windows 10 Pro with BitLocker Encryption</a></li>
</ul>
<p>That&#x27;s it and I hope you can set up dual boot without issues!</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/dual-boot">Dual Boot</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ubuntu">Ubuntu</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/windows">Windows</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024/06/19/weird-issue"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Don&#x27;t say it&#x27;s a weird bug, because it makes you look stupid</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preparation-in-windows" class="table-of-contents__link toc-highlight">Preparation in Windows</a></li><li><a href="#configure-bios-in-the-bios-menu" class="table-of-contents__link toc-highlight">Configure BIOS in the BIOS Menu</a></li><li><a href="#configure-ubuntu-partition" class="table-of-contents__link toc-highlight">Configure Ubuntu Partition</a></li><li><a href="#install-ubuntu" class="table-of-contents__link toc-highlight">Install Ubuntu</a></li><li><a href="#set-up-crypttab" class="table-of-contents__link toc-highlight">Set up <code>crypttab</code></a></li><li><a href="#reboot-and-some-remaining-issues" class="table-of-contents__link toc-highlight">Reboot and some remaining issues</a><ul><li><a href="#blue-screen-mok-management" class="table-of-contents__link toc-highlight">Blue screen MOK management</a></li><li><a href="#windows-bitlocker-issue" class="table-of-contents__link toc-highlight">Windows BitLocker Issue</a></li><li><a href="#wrong-timezone-after-dual-boot" class="table-of-contents__link toc-highlight">Wrong timezone after dual boot</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a><ul><li><a href="#about-full-disk-encryption" class="table-of-contents__link toc-highlight">About full disk encryption:</a></li><li><a href="#about-secure-boot" class="table-of-contents__link toc-highlight">About secure boot:</a></li><li><a href="#about-partition-and-bitlocker" class="table-of-contents__link toc-highlight">About partition and BitLocker:</a></li></ul></li></ul></div></div></div></div></div></div>
</body>
</html>