"use strict";(self.webpackChunkmy_wiki=self.webpackChunkmy_wiki||[]).push([[4138],{6223:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"computers/database","title":"Database","description":"Store and query data. I will add more later.","source":"@site/docs/computers/database.md","sourceDirName":"computers","slug":"/computers/database","permalink":"/computers/database","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Cybersecurity","permalink":"/computers/cybersecurity"},"next":{"title":"Keyboard","permalink":"/computers/keyboard"}}');var t=s(4848),r=s(8453);const a={},l="Database",o={},d=[{value:"Resources",id:"resources",level:2},{value:"Links",id:"links",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"database",children:"Database"})}),"\n",(0,t.jsx)(n.p,{children:"Store and query data. I will add more later."}),"\n",(0,t.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Database_normalization",children:"Database Normalization | Wikipedia"}),"\n\u2014 Structuring relational database for data integrity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://tontinton.com/posts/database-fundementals/",children:"Database Fundamentals"}),"\n(",(0,t.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=38655066",children:"HN"}),")","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The fundamental problems in the world of databases and common approaches to\nsolve them"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"links",children:"Links"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://soatok.blog/2023/03/01/database-cryptography-fur-the-rest-of-us/",children:"Database Cryptography Fur the Rest of Us | Soatok"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"A guide to the difficulty and possible solution for database encryption"}),"\n",(0,t.jsx)(n.li,{children:"Confused deputies, canonicalization attacks, multi-tenancy, and the\nadditional complexity in NoSQL databases"}),"\n",(0,t.jsx)(n.li,{children:"Searchable encryption: order-preserving or order-revealing encryption,\ndeterministic encryption, homomorphic encryption, searchable symmetric\nencryption, HMAC"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.figma.com/blog/how-figma-scaled-to-multiple-databases/",children:"How Figma Scaled to Multiple Databases"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Tactical fixes: upgrade RDS, read replicas, new DB for new use cases, add\nPgBouncer"}),"\n",(0,t.jsx)(n.li,{children:"Vertical partition: Move groups of tables onto different databases"}),"\n",(0,t.jsx)(n.li,{children:"A detailed description of how the migration was done to limit the\navailability impact to <1 minute"}),"\n",(0,t.jsx)(n.li,{children:"PgBouncer to redirect traffic. Logical replication to copy tables. LSNs to\nverify synchronization."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/getlago/lago/wiki/Is-ORM-still-an-%27anti-pattern%27%3F",children:"Is ORM still an 'anti-pattern'? | GitHub @getlago"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The paradigm mismatch between ORM data representation and relational data\nmodel, directed pointers vs. undirected graphs"}),"\n",(0,t.jsx)(n.li,{children:"Efficiency: The real issue is ORMs encourage poor practices. Data loaders\ncan handle N+1 problems in ORMs"}),"\n",(0,t.jsx)(n.li,{children:"Visibility problem: Translating SQL error to ORM error confuses developers"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.avestura.dev/blog/explaining-the-postgres-meme",children:"Explaining the Postgres Meme"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"There are numerous concepts in the iceberg meme of database"}),"\n",(0,t.jsx)(n.li,{children:"More like explaining database concepts using Postgres as an example"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://laplab.me/posts/inside-new-query-engine-of-mongodb/",children:"Inside the New Query Engine of MongoDB | Nikita Lapkov"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"A writeup of the rewrite of the query execution engine in MongoDB version\n7.0"}),"\n",(0,t.jsx)(n.li,{children:"2 major reasons for rewrite and the idea of a Slot Based Engine"}),"\n",(0,t.jsx)(n.li,{children:"Architecture, data flow and compiler for the slot based engine"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.epsio.io/blog/how-to-create-a-streaming-sql-engine",children:"How to create a Streaming SQL Engine | Episo"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Streaming SQL Engine: keep queries' results up to date without recalculating"}),"\n",(0,t.jsxs)(n.li,{children:["Nodes processing messages in a format of ",(0,t.jsx)(n.code,{children:"(key: modification)"}),", can perform\nfiltering, join, group by, etc."]}),"\n",(0,t.jsx)(n.li,{children:"Indexes and caching can optimize up to a point that they can't and streaming\nSQL engine just solves it"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://shekhargulati.com/2022/07/08/my-notes-on-gitlabs-postgres-schema-design/",children:"My Notes on GitLab's Postgres Schema Design | Shekhar Gulati"}),"\n(",(0,t.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=39413972",children:"HN"}),")","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["GitLab uses either ",(0,t.jsx)(n.code,{children:"serial"})," or ",(0,t.jsx)(n.code,{children:"bigserial"})," for primary keys, no UUID"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"text"})," type with ",(0,t.jsx)(n.code,{children:"CHECK"})," constraint to define length constraints"]}),"\n",(0,t.jsx)(n.li,{children:"Use foreign key constraints except for immutable tables like logs and events"}),"\n",(0,t.jsxs)(n.li,{children:["Partitioning on big tables to improve performance, e.g. ",(0,t.jsx)(n.code,{children:"PARTITION BY RANGE"}),"\nfor time-series data"]}),"\n",(0,t.jsxs)(n.li,{children:["Trigram text search with ",(0,t.jsx)(n.code,{children:"pg_trm"})," for faster ",(0,t.jsx)(n.code,{children:"LIKE"})," search"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"updated_at"})," only for tables that can be modified"]}),"\n",(0,t.jsxs)(n.li,{children:["Enums are ",(0,t.jsx)(n.code,{children:"smallint"})," rather than ",(0,t.jsx)(n.code,{children:"character varying"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://sqlite.org/draft/whybytecode.html",children:"Why SQLite Uses Bytecode"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Bytecode implementation vs tree-of-objects implementation of the prepared\nstatement"}),"\n",(0,t.jsx)(n.li,{children:"Bytecode: smaller, faster, easier to understand & debug, can be run\nincrementally"}),"\n",(0,t.jsx)(n.li,{children:"Tree-of-objects: query planning can be tweaked at runtime, dynamically\nself-tuning, and easy to parallelize"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Soft delete"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.a,{href:"https://brandur.org/fragments/deleted-record-insert",children:["Easy, alternative soft deletion: ",(0,t.jsx)(n.code,{children:"deleted_record_insert"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Hard delete and create a function that dump into a schemaless table"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.cultured.systems/2024/04/24/Soft-delete/",children:"Avoid the soft delete anti-pattern"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Few alternatives proposed, e.g. add state, temp table, use data warehouse"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Postgres"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://philbooth.me/blog/nine-ways-to-shoot-yourself-in-the-foot-with-postgresql",children:"Nine Ways to Shoot Yourself in the Foot with PostgreSQL"}),"\n(",(0,t.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=35684220",children:"HN"}),")","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"work_mem"}),", functions and procedures, triggers, ",(0,t.jsx)(n.code,{children:"NOTIFY"}),", ",(0,t.jsx)(n.code,{children:"EXPLAIN_ANALYZE"}),",\nCTEs v.s. subqueries (debatable), recursive CTEs, missing indexes for\nforeign keys, ",(0,t.jsx)(n.code,{children:"="})," v.s. ",(0,t.jsx)(n.code,{children:"IS NOT DISTINCT FROM"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://blog.mastermind.dev/indexes-in-postgresql",children:"Understanding Database Indexes in PostgreSQL | Mastermind Dev"}),"\n(",(0,t.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=35978757",children:"HN"}),")","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"A guide on database indexes, how they work and what are the types (BTree,\nHash, GiST, SP-GiST, GIN, BRIN)"}),"\n",(0,t.jsx)(n.li,{children:"Different ways to index: basic, partial, expression, covering"}),"\n",(0,t.jsx)(n.li,{children:"Maintenance: detecting unused indexes, bloats (unused space) or duplicates"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://rlopzc.com/posts/securing-your-postgresql-db-with-roles--privileges/",children:"Securing PostgreSQL DB with Roles & Privileges | Romario"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Scope and implement roles and privileges in PostgreSQL"}),"\n",(0,t.jsxs)(n.li,{children:["Commands like ",(0,t.jsx)(n.code,{children:"CREATE"}),", ",(0,t.jsx)(n.code,{children:"GRANT"}),", ",(0,t.jsx)(n.code,{children:"ALTER DEFAULT PRIVILEGES"}),", and\n",(0,t.jsx)(n.code,{children:"REASSIGN OWNED"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://scalegrid.io/blog/using-jsonb-in-postgresql-how-to-effectively-store-index-json-data-in-postgresql/",children:"Using JSONB in PostgreSQL | ScaleGrid"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Includes patterns & antipatterns, data structures, operators & functions,\nindexing JSONB columns in Postgres"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://hakibenita.com/postgresql-unused-index-size",children:"The Unexpected Find That Freed 20GB of Unused Index Space"}),"\n(",(0,t.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=37294793",children:"HN"}),")","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["A few tricks like ",(0,t.jsx)(n.code,{children:"pg_stat_all_indexes"})," and ",(0,t.jsx)(n.code,{children:"REINDEX"})," free up space"]}),"\n",(0,t.jsx)(n.li,{children:"Finding that Postgres index NULL values. Partial indexes can free up space"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.thenile.dev/blog/transaction-isolation-postgres",children:"Transaction Isolation in Postgres, explained"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"ACID - atomicity, consistency, isolation and durability"}),"\n",(0,t.jsx)(n.li,{children:"Isolation as defined in SQL 92 Standard: serializable isolation. Results of\nconcurrent transactions are the same as running them sequentially"}),"\n",(0,t.jsx)(n.li,{children:"Anomalies: dirty reads, non-repeatable reads, phantom reads"}),"\n",(0,t.jsx)(n.li,{children:"Postgres MVCC: anything lower than the lowest active XIDs, new versions of\nexisting rows and new rows are hidden"}),"\n",(0,t.jsx)(n.li,{children:"Postgres vacuuming: freeing XIDs for reuse since XIDs are limited to 32 bits"}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/postgres/postgres/tree/master/src/test/isolation",children:"Postgres isolation test suite"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://drew.silcock.dev/blog/how-postgres-stores-data-on-disk/",children:"How postgres stores data on disk"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Heap, segment, page, tuple"}),"\n",(0,t.jsxs)(n.li,{children:["Using the ",(0,t.jsx)(n.code,{children:"pageinspect"})," extension to see how data are stored"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://challahscript.com/what_i_wish_someone_told_me_about_postgres",children:"What I Wish Someone Told Me About Postgres"}),"\n(",(0,t.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=42111896",children:"HN"}),")","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Normalization and general advices"}),"\n",(0,t.jsxs)(n.li,{children:["Making ",(0,t.jsx)(n.code,{children:"psql"})," useful: use pager, auto-completion, backslash shortcuts, copy\nto CSVs"]}),"\n",(0,t.jsx)(n.li,{children:"Common issues in indexes, locks, transactions, and JSONB"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"SQL"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://stackoverflow.com/questions/12102200/get-records-with-max-value-for-each-group-of-grouped-sql-results",children:"Get records with max value for each group of grouped SQL results"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Just a page that I keep coming back to"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);